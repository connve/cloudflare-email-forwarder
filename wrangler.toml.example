name = "cloudflare-email-forwarder"
main = "src/index.ts"
compatibility_date = "2024-09-18"
workers_dev = false

# Required environment variables (set via wrangler secret put or dashboard):
# HTTP_WEBHOOK_URL - Webhook endpoint for forwarding emails
# HTTP_WEBHOOK_API_TOKEN - Bearer token for webhook authentication

# Required: KV namespace for retry queue
[[kv_namespaces]]
binding = "RETRY_QUEUE"
id = "your-retry-queue-kv-id"

# Optional: KV namespace for domain filtering
[[kv_namespaces]]
binding = "DOMAIN_FILTER"
id = "your-domain-filter-kv-id"

# Cron trigger to process retry queue every minute
[triggers]
crons = ["* * * * *"]

[observability]
enabled = true
head_sampling_rate = 1
